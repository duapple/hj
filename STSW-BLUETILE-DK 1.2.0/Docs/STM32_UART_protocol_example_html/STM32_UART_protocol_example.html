<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>STM32L - BlueNRG-1,2 network coprocessor (UART mode): NUCLEO-L152RE STEVAL-IDB007Vx (x=1,2)/STEVAL-IDB008Vx (x=1,2) Network coprocessor HW/SW setup, framework &amp; demo applications</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="STcustom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ST-logo-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STM32L - BlueNRG-1,2 network coprocessor (UART mode)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">NUCLEO-L152RE STEVAL-IDB007Vx (x=1,2)/STEVAL-IDB008Vx (x=1,2) Network coprocessor HW/SW setup, framework &amp; demo applications </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document describes an example of the BlueNRG-1 network coprocessor UART protocol implementation on a STM32L1xx microcontroller (NUCLEO-L152RE platform).<br />
 The UART network coprocessor framework is implementing according to the specification described on UART protocol specification doxygen documentation.<br />
 The document content is valid for BlueNRG-1,2 devices.<br />
 The BlueNRG-1,2 device is configured as a network coprocessor (UART mode).</p>
<h1><a class="anchor" id="U1"></a>
Hardware Platforms</h1>
<ul>
<li>BlueNRG-1 development platforms (order code: STEVAL-IDB007V1, STEVAL-IDB007V2) </li>
<li>BlueNRG-2 development platforms (order code: STEVAL-IDB008V1, STEVAL-IDB008V2) </li>
<li>STM32L152RE Nucleo platform (order code: NUCLEO-L152RE)</li>
</ul>
<ul>
<li>NOTES: <ol>
<li>
When using a NUCLEO-L152RE platform, install the related ST-Link, ST-Link/V2, ST-Link/V2-1 USB driver signed for XP, Windows7, Windows8 (STSW-LINK009). </li>
<li>
When using a NUCLEO-L152RE platform, make sure the ST-Link firmware is updated to latest version available on ST web page. This can be checked/achieved by using the STM32 ST-LINK Utility v3.6.0 (or later). </li>
</ol>
</li>
</ul>
<h1><a class="anchor" id="U2"></a>
Hardware Platforms Prerequisites: connections and HW modifications</h1>
<ul>
<li>The following connections must be performed between the 2 platforms (Nucleo-L152RE &amp; STEVAL-IDB007Vx/STEVAL-IDB008Vx):</li>
</ul>
<table  border="1">
<tr>
<th>Pin Function MCU side </th><th>Nucleo-L152RE pin/connector (UART1) </th><th>STEVAL-IDB007Vx/STEVAL-IDB008Vx pin/connector  </th></tr>
<tr>
<td><b> UART TX </b> </td><td>PA9/CN10.21/CN5.1 </td><td>IO11 (UART RX) </td></tr>
<tr>
<td><b> UART RX </b> </td><td>PA10/CN10.33/CN9.3 </td><td>IO8 (UART TX)  </td></tr>
<tr>
<td><b> UART CTS </b> </td><td>PA11/CN10.14 </td><td>IO6 (UART RTS)  </td></tr>
<tr>
<td><b> UART RTS </b> </td><td>PA12/CN10.12 </td><td>IO13 (UART CTS) </td></tr>
<tr>
<td><b>BLUENRG-1,2 BOOT (1) </b></td><td>PB14/CN10.28 </td><td>IO7 </td></tr>
<tr>
<td><b>BLUENRG-1,2 RESETN </b> </td><td>PA8/CN10.23/CN9.8 </td><td>RESETN </td></tr>
<tr>
<td><b> VDD </b> </td><td>VDD </td><td>VBLUE </td></tr>
<tr>
<td><b> GND </b> </td><td>GND </td><td>GND </td></tr>
<tr>
</tr>
</table>
<table class="doxtable">
</table>
<p><b> Note (1)</b> : BLUENRG-1,2 BOOT pin to be connected only for bootloader mode.</p>
<ul>
<li>The following HW modifications must be done on the BlueNRG-1/STEVAL-IDB007Vx, BlueNRG-2/STEVAL-IDB008Vx platforms in order to use it as Network coprocessor with Nucleo-L152RE: <ol>
<li>
Remove resistors R49, R48, R27. </li>
<li>
Remove capacitors C26. </li>
<li>
Open JP1 jumper. </li>
<li>
JP2 jumper in 1-2 position.</li>
</ol>
</li>
</ul>
<h1><a class="anchor" id="U3"></a>
Software Prerequisites: SW Configuration</h1>
<ul>
<li>The following SW steps must be performed on the selected BLE platform (STEVAL-IDB007Vx or STEVAL-IDB008Vx): <ul>
<li>
Open the BlueNRG-1 Flasher tool and configure the BlueNRG-1,2 device a network coprocessor (UART mode), by loading the Firmware\BLE_Examples\BlueNRG-1\DTM\DTM_UART_16MHz_sleep.hex binary file on the selected BlueNRG-1 platform or Firmware\BLE_Examples\BlueNRG-2\DTM\DTM_UART_32MHz_sleep.hex binary file on the selected BlueNRG-2 platform</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="U4"></a>
STM32L1xx  Network coprocessor framework structure</h1>
<table  border="1">
<tr>
<th></th><th>Path </th><th>Description  </th></tr>
<tr>
<td><b> Nucleo-L152RE SDK Drivers </b> </td><td>Library\STM32L\Drivers\BSP\STM32L1xx_Nucleo </td><td>SDK Drivers for NUCLEOE-L152RE Leds, COM, timers </td></tr>
<tr>
<td><b> STM32L1 Nucleo - BlueNRG-1,2 </b> </td><td>Library\STM32L\Drivers\BSP\STM32L1xx_BlueNRG1 </td><td>NUCLEO-L152RE UART driver for interfacing to BlueNRG-1,2 network coprocessor  </td></tr>
<tr>
<td><b> STM32L1 CMSIS </b> </td><td>Library\STM32L\Drivers\CMSIS </td><td>CMSIS files for STM32LXXX  </td></tr>
<tr>
<td><b> STM32L1 Cube HAL drivers </b> </td><td>Library\STM32L\Drivers\STM32L1xx_HAL_Driver </td><td>STM32L1xx HAL drivers (Cube framework) </td></tr>
<tr>
<td><b> HAL drivers </b> </td><td>Library\STM32L\Drivers\Middlewares\ST\STM32_BlueNRG1\HAL </td><td>HAL drivers (osal, low power, timers) </td></tr>
<tr>
<td><b> UART HAL drivers </b> </td><td>Library\STM32L\Drivers\Middlewares\ST\STM32L1xx_HAL_BlueNRG1_Drivers </td><td>UART middlewares utilities </td></tr>
<tr>
<td><b> ACI framework </b> </td><td>Library\STM32L\Middlewares\ST\STM32_BlueNRG1\SimpleBlueNRG1_HCI </td><td>BLE stack ACI framework APIs for interfacing to the BlueNRG-1,2 BLE stack features and events </td></tr>
<tr>
<td><b> BLE Test application </b> </td><td>Project\STM32L\DTM </td><td>BLE Direct Test Mode application  </td></tr>
</table>
<h1><a class="anchor" id="U5"></a>
Demonstration Applications</h1>
<ul>
<li>The following STM32L - BlueNRG-1,2 network coprocessor (UART mode) demonstrations application are available (EWARM IAR toolchain 7.70 or later): <ol>
<li>
<b>BLE Beacon </b> application which configures a beacon device: <ul>
<li>
IAR project supporting STM32L152 device (workspace: Release_UART, Release_LowPower_UART). </li>
</ul>
</li>
<li>
<b>BLE Chat Master &amp; Slave </b> application which allows to target a BLE Chat application scenario with same binary image:<ul>
<li>
IAR project supporting STM32L152 device (workspace: Release). </li>
</ul>
</li>
<li>
<b> Sensor Demo </b>application with emulated acceleration and environmental sensors values (emulated): <ul>
<li>
IAR project supporting STM32L152 device (workspaces: Release_UART, Release_LowPower_UART).</li>
</ul>
</li>
<li>
<b> DTM </b>application to be programmed on STM32L152- NUCLEO L152RE in order to use the BlueNRG GUI tool (file STM32L_Nucleo_DTM_UART.hex): <ul>
<li>
IAR project supporting STM32L152 device (workspace: DTM_UART).</li>
</ul>
</li>
</ol>
</li>
<li>NOTES: <ul>
<li>
Prebuilt binary images are available on \Firmware\STM32L folder </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright &copy; 2018 by STMicrolectronics. All rights reserved.<br>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
